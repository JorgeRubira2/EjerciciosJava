<!doctype html>
<html xmlns:th="https://www.thymeleaf.org" lang='es'>
    <head>
        <title>Gestion clientes</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css"/>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css"/>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/5.1.0/flatly/bootstrap.min.css"/>

        <style>
            .main{
                margin-top: 20px;
            }
            .top{
                margin:20px 0px;
             
            }
            h4{
                margin-top:20px;
            }
        </style>
    </head>
    <body>
        <div class="container main">

            <div class="top">
                <input type="button" id="nuevo" value="Nuevo" class="btn btn-primary"/>
                <input type="button" id="borrar" value="Borrar" class="btn btn-secondary"/>
                <input type="button" id="modificar" value="Editar" class="btn btn-info"/>
            </div>
            <table class="table table-bordered table-hover ">                
                <thead>
                    <tr>
                        <th width="10%">Seleccionar/<br>visualizar</th>
                        <th>Name</th>
                        <th>Account Name</th>
                        <th>Email and Phone</th>
                    </tr>
                </thead>
                <tr th:each="cli:${clientes}" class='text-center'>
                    <td><input type="radio" name="id" th:value="${cli.id}"/>
                        <a th:attr="onclick=|mostrar('${cli.id}')|" title="Mostrar cliente"><i class="far fa-eye"></i></a>
                    </td>
                    <td class='text-left' ><div th:text="${cli.firstName+' '+cli.lastName}"></div>
                    <div class="text-secondary" th:text="${cli.title}"></div></td>
                    <td ><i class="fas fa-folder-open" style='color:orange'> </i><span th:text="${' '+cli.primaryAccount}"></span></td>
                    <td >
                        <div>
                            <i class="fas fa-mobile-alt"></i>
                            <span th:text="${' '+cli.telefono}"></span>
                        </div>
                        <div>
                            <i class="far fa-envelope"></i>
                             <span th:text="${' '+cli.email}"></span>
                        </div>
                    </td>
                </tr>
            </table>
        </div>
        <div id="nuevoCliente" style="display:none">
            <form action="ejercicio7" method="post">
                <input type="submit" value="Save" class="btn btn-primary"/>
                <div class="row">
                    <div class="col-5"> <label class="form-label" for="firstName">First name: </label><input type="text" name="firstName" class="form-control"/></div>
                    <div class="col-5"> <label class="form-label" for="primaryAccount">Primary Account: </label><input type="text" name="primaryAccount" class="form-control"/></div>
                    <div class="col-5"> <label class="form-label" for="lastName">Last name: </label><input type="text" name="lastName" class="form-control"/></div>
                    <div class="col-5"> <label class="form-label" for="telefono">Teléfono: </label><input type="text" name="telefono" class="form-control"/></div>
                    <div class="col-5"> <label class="form-label" for="title">Título: </label><input type="text" name="title" class="form-control"/></div>
                    <div class="col-5"> <label class="form-label" for="email">Email: </label><input type="email" name="email" class="form-control"/></div>
                    <div class="col-10"><span class="form-label">Descripción:</span> <textarea name="descripcion" class="form-control"></textarea></div>
                    
                    <h4>Address Information</h4>
                    <div class="col-10"><span class="form-label">Primary Address:</span><textarea class="form-control" name="direccion"></textarea> </div>
                    <div class="col-5"> <label class="form-label" for="city">City: </label><input type="text" name="city" class="form-control"/></div>
                    <div class="col-5"> <label class="form-label" for="estado">Estate: </label><input type="text" name="estado" class="form-control"/></div>
                    <div class="col-5"> <label class="form-label" for="country">Country: </label><input type="text" name="country" class="form-control"/></div>
                    <div class="col-5"> <label class="form-label" for="codigoPostal">Postal code: </label><input type="number" name="codigoPostal" class="form-control"/></div>                
                </div>
            </form>
        </div>
        <div id="datosCliente" style="display:none">
            <form action="ejercicio7" method="post">
                <div class="row">
                    <div class="col-5"> 
                        <label class="form-label" for="firstName">First name: </label>
                        <input type="text" name="firstName" class="form-control" />
                    </div>
                    <div class="col-5"> 
                        <label class="form-label" for="primaryAccount">Primary Account: </label>
                        <input type="text" name="primaryAccount" class="form-control" /></div>
                    <div class="col-5"> 
                        <label class="form-label" for="lastName">Last name: </label>
                        <input type="text" name="lastName" class="form-control" /></div>
                    <div class="col-5"> 
                        <label class="form-label" for="telefono">Teléfono: </label>
                        <input type="text" name="telefono" class="form-control" /></div>
                    <div class="col-5"> 
                        <label class="form-label" for="title">Título: </label>
                        <input type="text" name="title" class="form-control" /></div>
                    <div class="col-5"> 
                        <label class="form-label" for="email">Email: </label>
                        <input type="email" name="email" class="form-control" /></div>
                    <div class="col-10">
                        <span class="form-label">Descripción:</span> 
                        <textarea name="descripcion" class="form-control" ></textarea></div>
                 
                    <h4>Address Information</h4>
                    <div class="col-10">
                        <span class="form-label">Primary Address:</span>
                        <textarea class="form-control" name="direccion" ></textarea> </div>
                    <div class="col-5"> 
                        <label class="form-label" for="city">City: </label>
                        <input type="text" name="city" class="form-control" /></div>
                    <div class="col-5"> 
                        <label class="form-label" for="estado">Estate: </label>
                        <input type="text" name="estado" class="form-control" /></div>
                    <div class="col-5">
                        <label class="form-label" for="country">Country: </label>
                        <input type="text" name="country" class="form-control" /></div>
                    <div class="col-5"> 
                        <label class="form-label" for="codigoPostal">Postal code: </label>
                        <input type="number" name="codigoPostal" class="form-control" /></div>                
                </div>
            </form>
        </div>
        <script src="https://code.jquery.com/jquery-3.6.0.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.min.js" ></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/bootbox.js/5.5.2/bootbox.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/jquery-deserialize@2.0.0-rc1/src/jquery.deserialize.min.js"></script> 
        <script>
            $(document).ready(function () {
                '';
                $("#nuevo").click(formulario);

                $("#modificar").click(function () {
                    var rad = $("input:radio[name=id]:checked").val();
                    $(location).attr("href", "ejercicio7/" + rad);
                });
                $("#borrar").click(function () {
                    var rad = $("input:radio[name=id]:checked").val();
                    $(location).attr("href", "ejercicio7/delete/" + rad);
                });
            });

            function formulario() {
                bootbox.dialog({
                    title: "Nuevo Cliente",
                    size: "large",
                    message: $("#nuevoCliente").html()

                });
            }
            function mostrar(pID) {
                $.ajax({
                    url: "ejercicio7/ajax/" + pID, //<--Ejecutamos del contra esta url
                    data: {//<- Parametros ?id=4
                        id: pID,
                    },
                    dataType: "json",
                    success: function (pJson) {    //<- Nos devuelven la respuesta. 
                        bootbox.dialog({
                            title:'Cliente',
                            size:'large',
                            message: "<div id='formBB'>" + $('#datosCliente').html() + "</div>"
                        });
                        $('#formBB form').deserialize(pJson);
                    },
                    error: function (err) {
                        alert('Si la URL esta mal. Codigo 404')
                    }
                })
            }
        </script>
    </body>
</html>
